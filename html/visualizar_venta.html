<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizar Ventas - King's Pizza</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/menu_principal.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../css/visualizar_venta.css">
</head>
<body>
    <!-- El sidebar se cargará automáticamente con load_sidebar.js -->
    
    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Top Bar -->
        <header class="top-bar">
            <div class="top-bar-left">
                <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Abrir menú">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="page-title">Visualizar Ventas</h1>
            </div>
            <div class="top-bar-right">
                <div class="current-date" id="currentDate"></div>
                <div class="notifications">
                    <button class="notification-btn" aria-label="Notificaciones">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Page Content -->
        <div class="content-wrapper">
            <!-- Búsqueda de Ventas -->
            <div class="card">
                <div class="card-body">
                    <div class="busqueda-form">
                        <input 
                            type="text" 
                            id="campoBusqueda" 
                            class="form-control input-busqueda-principal" 
                            placeholder=""
                        >
                        
                        <button class="btn btn-light btn-buscar-principal" onclick="buscarVenta()">
                            BUSCAR
                        </button>
                        
                        <button class="btn btn-light btn-detalle-principal" onclick="mostrarDetalle()" disabled id="btnDetalle">
                            DETALLE
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tabla de Ventas -->
            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="tabla-ventas-principal">
                            <thead>
                                <tr>
                                    <th>Nro COMPROBANTE</th>
                                    <th>FECHA</th>
                                    <th>CLIENTE</th>
                                    <th>TOTAL</th>
                                    <th>Tipo Pago</th>
                                </tr>
                            </thead>
                            <tbody id="tbodyVentas">
                                <!-- Las filas se cargarán dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Botones de acción -->
            <div class="acciones-principales">
                <button class="btn btn-info btn-exportar-principal" onclick="exportarVentas()">
                    Exportar
                </button>
                <button class="btn btn-danger btn-salir-principal" onclick="salir()">
                    Salir
                </button>
            </div>
        </div>
    </main>

    <!-- Modal de detalle de venta -->
    <div id="modalDetalle" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-file-invoice"></i> Comprobante de Pago</h2>
                <button class="btn-close" onclick="cerrarModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="comprobante">
                <div class="comprobante-header">
                    <div class="empresa-info">
                        <h3><i class="fas fa-pizza-slice"></i> KING'S PIZZA</h3>
                        <p>RUC: 20123456789</p>
                        <p>Av. Principal 123, Lima - Perú</p>
                        <p>Tel: (01) 234-5678</p>
                    </div>
                    <div class="comprobante-numero">
                        <h4>BOLETA DE VENTA</h4>
                        <p>N° <span id="detalleNroComprobante">001-0001</span></p>
                    </div>
                </div>

                <div class="comprobante-info">
                    <div class="info-row">
                        <span class="label">Fecha:</span>
                        <span id="detalleFecha" class="value">--/--/----</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Hora:</span>
                        <span id="detalleHora" class="value">--:--:--</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Cliente:</span>
                        <span id="detalleCliente" class="value">-----------</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Tipo de Pago:</span>
                        <span id="detalleTipoPago" class="value">-----------</span>
                    </div>
                </div>

                <div class="comprobante-productos">
                    <table class="tabla-detalle">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Cant.</th>
                                <th>Precio</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody id="tablaDetalleProductos">
                            <!-- Se llenará dinámicamente -->
                        </tbody>
                    </table>
                </div>

                <div class="comprobante-totales">
                    <div class="total-row">
                        <span class="label">Subtotal:</span>
                        <span id="detalleSubtotal" class="value">S/ 0.00</span>
                    </div>
                    <div class="total-row">
                        <span class="label">IGV (18%):</span>
                        <span id="detalleIGV" class="value">S/ 0.00</span>
                    </div>
                    <div class="total-row total-final">
                        <span class="label">TOTAL:</span>
                        <span id="detalleTotal" class="value">S/ 0.00</span>
                    </div>
                </div>

                <div class="comprobante-footer">
                    <p>¡Gracias por su compra!</p>
                    <p>Vuelva pronto</p>
                </div>

                <div class="modal-acciones">
                    <button class="btn btn-primary" onclick="imprimirComprobante()">
                        <i class="fas fa-print"></i> Imprimir
                    </button>
                    <button class="btn btn-danger" onclick="descargarPDF()">
                        <i class="fas fa-file-pdf"></i> Descargar PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="../js/load_sidebar.js"></script>
    <script src="../js/menu_principal.js"></script>
    <script src="../js/visualizar_venta.js"></script>
</body>
</html>